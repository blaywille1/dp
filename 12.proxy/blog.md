У профессии агента есть другое название в Китае, брокер по недвижимости и страховой брокер, фактически, эта профессия
называется агентством недвижимости или страховым агентством за рубежом. Как следует из названия, именно они помогают нам
справляться с этими профессиональными областями, относительно незнакомыми большинству из нас. Модель прокси такая же, но
в то же время в этой статье кратко рассказывается, как работают прямой и обратный прокси.


***

- Определение GoF: предоставить прокси для других объектов для управления доступом к этому объекту

***

> AbCD类图

![代理模式](https://raw.githubusercontent.com/blaywille1/dp/master/12.proxy/img/proxy.jpg)


> 代码实现

```php
<?php

interface Subject
{
    public function Request();
}

class RealSubject implements Subject
{
    function Request()
    {
        echo "Реальная операция", PHP_EOL;
    }
}

class Proxy implements Subject
{
    private $realSubject;

    public function __construct()
    {
        $this->realSubject = new RealSubject();
    }

    public function Request()
    {
        echo "Работа агента", PHP_EOL;
        $this->realSubject->Request();
    }
}

$proxy = new Proxy();
$proxy->Request();

// Удаленный агент: SDK стороннего интерфейса
// Виртуальный прокси: асинхронная загрузка изображений
// Агент защиты и интеллектуальное руководство: Защита разрешений



```

- Реализация прокси-модели на самом деле очень проста, и вы можете часто использовать ее непреднамеренно.
- Обратите внимание на разницу между режимом прокси и декоратором и адаптером. Кроме того, режим метода шаблона также
  очень похож на него.
- Декораторы обычно используются для украшения объектов, в которых поведение методов будет улучшаться, в основном для
  украшения объектов.
- Адаптер, как правило, изменяет поведение метода, цель состоит в том, чтобы сохранить единство интерфейса, но получить
  другую реализацию
- Режим шаблонного метода, о нем мы поговорим позже, поскольку вы знаете, что шаблонный метод - это метод объединения и
  вызова подклассов в абстрактном классе.
- Существует несколько форм режима прокси: удаленный прокси (например, сторонний интерфейс SDK), виртуальный прокси (
  например, асинхронная загрузка изображений), агент защиты и интеллектуальное руководство (например, защита разрешений)
  и наиболее распространенный прокси, реализованный нашим кодом, Фактически, это позволить прокси-классу заменить работу
  реального класса.

**

**
完整代码：[https://github.com/blaywille1/dp/blob/master/12.proxy/source/proxy.php](https://github.com/blaywille1/dp/blob/master/12.proxy/source/proxy.php)**

## пример

Функцию SMS нельзя остановить, на этот раз используйте простой режим прокси, чтобы добавить подсказки до и после!


> 短信发送类图

![短信发送代理模式版](https://raw.githubusercontent.com/blaywille1/dp/master/12.proxy/img/proxy-msg.jpg)

**
完整源码：[https://github.com/blaywille1/dp/blob/master/12.proxy/source/proxy-msg.php](https://github.com/blaywille1/dp/blob/master/12.proxy/source/proxy-msg.php)**

```php
<?php

interface SendMessage
{
    public function Send();
}

class RealSendMessage implements SendMessage
{
    public function Send()
    {
        echo 'Отправка SMS ...
', PHP_EOL;
    }
}

class ProxySendMessage implements SendMessage
{
    private $realSendMessage;

    public function __construct($realSendMessage)
    {
        $this->realSendMessage = $realSendMessage;
    }

    public function Send()
    {
        echo 'SMS начать отправку
', PHP_EOL;
        $this->realSendMessage->Send();
        echo 'Окончание отправки СМС
', PHP_EOL;
    }
}

$sendMessage = new ProxySendMessage(new RealSendMessage());
$sendMessage->Send();

```

> 说明

- Пример очень простой, или реализация обычного прокси, здесь мы говорим о прямом прокси и обратном прокси.

- Большинство PHP-разработчиков хорошо знают обратный прокси, в конце концов, теперь Nginx заменил Apache в качестве
  стандартной конфигурации PHP. Когда мы посещаем веб-сайт, определенные пути или доменные имена не обязательно
  находятся на этом сервере. Они являются прямым прокси-сервером для других серверов или даже сайтов других людей на
  сервере. Для тех из нас, кто просматривает веб-сайт, мы не знаем. Ситуация, когда нас необъяснимо проксируют, не зная,
  что это обратный прокси-сервер, что, как правило, является необходимым знанием в фоновой эксплуатации и обслуживании
  службы!

